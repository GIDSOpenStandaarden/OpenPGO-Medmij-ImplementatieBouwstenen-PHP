language: php
dist: trusty
sudo: false

addons:
  sonarcloud:
    organization: "othillo-github"
    token:
      secure: "jf1HIxbjHxTCiBByYBFgn7KUWOvkGdUV1aTAbAAfT+cTy7aw5dJ+que/c8sDRbvhoexItZJ9BqU7L3Af0UBpFkou8tmb60NPbBlt7qD1HY7ukvQh6pcnWNc11SNuDF3Pn3PqLhur56BFSa/LiOlq3BgTYRI794NUxnH4hYFiS2R18gPJLXPZV9X8N9wLIpsMcNnz8mZVByFVD/6QQiIv6PCvMpUDrGmKzL/L2NJmLLtmoiuhO0q6yhIqCDKVwZL6M1ntg+E+9yv0YXcoL97OefweudQbL4z2s+sm1WLz5+5jfRbp1t1ca+IkL1bImUeAqJu5WP/sm0KkmgfZJeMvAPNVxO+Srml89J5eFlmGyXs9l/wHNHd2RBEYcT79PNfmEokwdJah/v4TgrZnGGpE4IrQDQ/3Itd9AWngqpvnNfq/QeJc576bJPYnD5CyJyYKcuYUdLh5YfTQuArexe+hok3SsD5KqLczevL+w7t48UVDUBctbzTs1ROF24EuFPlsDDkszcA9vT3nyDhkEf+aRevF5ultXDn7Dhq7N2I4HPGsuxXbNgTMV5XBHeluW58iwlRSZi6s0Hp7mIWkl3LsGEb6cNMMpqtC2Sbq9sfR2g2t+aQt/SXO+DrzdVr0Cp+stNNuNUcc0lYEMitHkgzc5TtcRJsl4bt68SfzUbsG51w="

matrix:
  include:
  - php: 7.1
  - php: 7.2
  fast_finish: true

install:
- composer validate --strict
- composer install

script:
- vendor/bin/phpunit --stop-on-failure --log-junit=junit.xml --coverage-clover=coverage.xml
- vendor/bin/php-cs-fixer fix --config=".php_cs" --allow-risky=yes --dry-run --diff --verbose
- sonar-scanner

branches:
  only:
  - master
